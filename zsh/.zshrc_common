PATH="$HOME/bin:$HOME/.home/bin:$HOME/.home/bin/git:$PATH"

# Source z
if [[ -s "/usr/local/etc/profile.d/z.sh" ]]; then
	. /usr/local/etc/profile.d/z.sh
fi

[ -f $HOME/.home/zsh/.fzf.zsh ] && source $HOME/.home/zsh/.fzf.zsh

# Note: git's git-completion.zsh file conflicts with zsh's _git file, you may have to rm/mv `/usr/local/share/zsh/site-functions/_git -> ../../../Cellar/git/2.14.1/share/zsh/site-functions/_git`
# TODO: Maybe brew install order matters here?
source "$HOME/.home/bin/git/.zcompletion"

# C-b to erase current prompt, run a command, then return the current prompt as it was
bindkey '^B' push-line

# Settings
EDITOR="vim"
PAGER="less"
VISUAL="vim"

# Aliases
alias rsync.exact="rsync -rtpogxv -P -l -H"
alias rsync.loose="rsync -zvru -P"
alias rgrep="grep -r"
alias vimconflicts='vim -p +/"<<<<<<<" $( git diff --name-only --diff-filter=U | uniq | xargs )'
alias -g g="| grep"
alias -g l="| less"
alias nnn="NNN_SHOW_HIDDEN=1 nnn -S"
alias df="pydf 2>/dev/null || df -h"
alias co="git checkout"
alias doit!="sudo $(history -p !!)"
alias groups="defaults read com.jamf.connect.state UserGroups"

# Postgres
alias pgup="launchctl load ~/Library/LaunchAgents/homebrew.mxcl.postgresql.plist"
alias pgdown="launchctl unload ~/Library/LaunchAgents/homebrew.mxcl.postgresql.plist"

# Image magic
#export PATH="/usr/local/opt/imagemagick@6/bin:$PATH"


# Platform dev
export PLATFORM_DEV=$HOME/dev 
shovel() ( $PLATFORM_DEV/script/run shovel "$@"; )
alias de='docker exec -e COLUMNS="$(tput cols)" -e LINES="$(tput lines)" -ti'
# alias dps='docker ps --no-trunc --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}\t{{.Command}}\t{{.Image}}"' 
alias dps='docker ps â€”format "table {{.Names}}\t{{.Status}}\t{{.Ports}}\t{{.Command}}\t{{.Image}}"'
fpath=($PLATFORM_DEV/misc/completion/ $fpath)
autoload -U compinit && compinit
autoload -U bashcompinit && bashcompinit

mvln(){
	# Get an absolute path for the target
	tp="`dirname $2`/`basename $2`/"
	tp="$tp:A"

	# If the target doesn't include a new filename, use the same filename as the source
	if [ -d "$2" ]; then
		t="$tp/`basename $1`"
	else
		t="$tp"
	fi

	# Full path to source, even if it was specified as relative
	s="$1:A"

	mv "$s" "$t" && ln -s "$t" "$s"
}

# Lang Manager
. ~/.home/asdf/asdf.sh
# append completions to fpath
fpath=(${ASDF_DIR}/completions $fpath)
# initialise completions with ZSH's compinit
autoload -Uz compinit
compinit

# Load any local zshrc overrides
if [ -s ~/.zshrc_local ]; then
	. ~/.zshrc_local
fi

export GOBIN=~/.go/bin
export PATH=$GOBIN:$PATH
